{% extends 'crmBundle::base.html.twig' %}
{% block body %}
<div class="container-fluid">
	<h2>Maquinaria</h2>
	{% if permisos.maquinariaAgregar == 1%}<a href="/maquinaria/agregar"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Agregar Maquinaria</a>{% endif %}
	<div role="tabpanel">	
		<ul id="myTab" class="nav nav-tabs" role="tablist">
			<li role="presentation" class="active"><a href="#informacion" aria-controls="informacion" role="tab" data-toggle="tab">Inventtario de maquinaria</a></li>
			<li role="presentation"><a href="#foto" aria-controls="busqueda" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Busqueda</a></li>
		</ul>
	<div class="tab-content">
		<div role="tabpanel" class="tab-pane active" id="informacion">
			<table  class="table table-hover table table-condensed table table-striped">
				<thead>
		{% if permisos.maquinariaEliminar==1%}<td></td>{% endif %}
					<th>ECO</th>
					<th>No Serie</th>
					<th>Nombre</th>
					<th>A&ntilde;os</th>
					<th>Modelo</th>
					<th>Status</th>
					<th>Marca</th>
					<th>Activa</th>
		{% if permisos.maquinariaEditar==1%}<th>Editar</th>{% endif %}
				</thead>
				{% for entity in entities %}
				<tr>
		{% if permisos.maquinariaEliminar==1%}<td><a href="/maquinaria/eliminar/{{ entity.id }}"><span style="color: red;" class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></td>{% endif %}
					<td>{{ entity.eco }}</td>	
					<td>{{ entity.numeroSerie }}</td>	
					<td>{{ entity.nombre }}</td>	
					<td>{{ entity.years }}</td>	
					<td>{{ entity.modelo }}</td>	
					<td>{{ entity.status }}</td>	
					<td>{{ entity.marca }}</td>	
					<td>{% if permisos.maquinariaEditar==1%}
						<input type ="checkbox" {% if entity.isActive ==1 %} checked="checked"{% endif %}class="isActive" idMaquinaria="{{ entity.id}}">
						{% else %}
							{% if entity.isActive ==1 %}
								<span style="color:#5cb85c; " class="glyphicon glyphicon-ok" aria-hidden="true"></span
							{% else %}
								<span style="color: red;" class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
							{% endif %}	
						{% endif %}	
					 </td>
		{% if permisos.maquinariaEditar==1%}
			<td><a href="/maquinaria/editar/{{ entity.id }}"><button class="btn btn-info"><span style="color: #000;" class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button></a></td>
			{% endif %}
				</tr>
				{% endfor %}
			</table>
		</div>
		<div role="tabpanel" class="tab-pane" id="busqueda">
		</div>
	</div>
</div>

{% endblock %}
{% block javascripts %} 
{{parent()}}
<script src="{{ asset('public/js/formvalidation0.6.2/js/formValidation.js')}}"></script>
<script src="{{ asset('public/js/formvalidation0.6.2/js/framework/bootstrap.js')}}"></script>
<script src="{{ asset('public/js/formvalidation0.6.2/js/language/es_ES.js')}}"></script>
<script src="{{ asset('public/js/formvalidation0.6.2/js/language/en_US.js')}}"></script>
<script type="text/javascript">
$(document).ready(function() {	

	$( ".isActive" ).click(function() {
		var isActive=0;
		 if($(this).prop('checked') == true){
			 isActive=1;
		 }
		 var jsonObj = []; //generar array de json
		var item = {};
		item ["idMaquinaria"] = $(this).attr('idMaquinaria');
		item ["isActive"] = isActive;
		jsonObj.push(item);
		$(this).prop("disabled", true);
		var elemnt =$(this);
		$.ajax({//mandar cambios a bd
	 				type: "POST",
	 				url: "/mauinaria/isActive",
	 				contentType:'application/json',
	 				data: JSON.stringify(jsonObj),
	 				dataType:'json'
	 				//async: false
	 			}).always(function() {
	 			    $(elemnt).removeAttr( "disabled" );
	 			  });
 			
		
		  //alert( $(this).attr('idPropiedades') );
		});

});
</script>
{% endblock %}

